       SUBROUTINE UMAT(STRESS,STATEV,DDSDDE,SSE,SPD,SCD,
     1 RPL,DDSDDT,DRPLDE,DRPLDT,
     2 STRAN,DSTRAN,TIME,DTIME,TEMP,DTEMP,PREDEF,DPRED,CMNAME,
     3 NDI,NSHR,NTENS,NSTATV,PROPS,NPROPS,COORDS,DROT,PNEWDT,
     4 CELENT,DFGRD0,DFGRD1,NOEL,NPT,LAYER,KSPT,KSTEP,KINC)
C
      INCLUDE 'ABA_PARAM.INC'
C
      CHARACTER*80 CMNAME
      DIMENSION STRESS(NTENS),STATEV(NSTATV),
     1 DDSDDE(NTENS,NTENS),DDSDDT(NTENS),DRPLDE(NTENS),
     2 STRAN(NTENS),DSTRAN(NTENS),TIME(2),PREDEF(1),DPRED(1),
     3 PROPS(NPROPS),COORDS(3),DROT(3,3),DFGRD0(3,3),DFGRD1(3,3)


C LOCAL VARIABLES --------------------------------------------------------
      real(kind=8) C11g,C12g,C13g,C22g,C23g,C33g,C1212g,C1313g,C2323g
      real(kind=8) C11i(30),C12i(24),C13i(22),C22i(30),C23i(23)
      real(kind=8) C33i(31),C1212i(35),C1313i(36),C2323i(40)
      real(kind=8) tC11i(30),tC12i(24),tC13i(22),tC22i(30),tC23i(23)
      real(kind=8) tC33i(31),tC1212i(35),tC1313i(36),tC2323i(40)
      real(kind=8) Tref,b1,b2,b3,b4,b5,b6,b7,b8,b9,DelTr,DelTrp,DeltXi
      real(kind=8) aT, aTm, aTp, Theta, Thetap, Tinit
      real(kind=8) qC11(30),qC121(24),qC122(24),qC131(22),qC132(22)
      real(kind=8) qC22(30),qC231(23),qC232(23),qC33(31)
      real(kind=8) qC1212(35),qC1313(36),qC2323(40)
      real(kind=8) qC11p(30),qC121p(24),qC122p(24),qC131p(22),qC132p(22)
      real(kind=8) qC22p(30),qC231p(23),qC232p(23),qC33p(31)
      real(kind=8) qC1212p(35),qC1313p(36),qC2323p(40)
      real(kind=8) svC11,svC121,svC122,svC131,svC132,svC22
      real(kind=8) svC231,svC232,svC33,svC1212,svC1313,svC2323
      real(kind=8) C11tot,C12tot,C13tot,C22tot,C23tot,C33tot
      real(kind=8) C1212tot,C1313tot,C2323tot
      real(kind=8) eps(6),epsp(6),deps(6)
      real(kind=8) Lg(6,6),dsigg(6)
      real(kind=8) LVISC(6,6),scal
C
      integer i,ThMode
      Integer NC11,NC12,NC13,NC22,NC23,NC33,NC1212,NC1313,NC2323

C MECHANICAL PROPERTIES --------------------------------------------------

      C11g = 4.866573773d0

      C11i = (/ 0.112352581d0,0.03253172d0,0.054983803d0,
     $ 0.091793518d0,0.163007659d0,0.205866952d0,
     $ 0.160328485d0,0.258100196d0,0.357976863d0,
     $ 0.382308341d0,0.400706061d0,0.381404081d0,
     $ 0.01469538d0,0.353512603d0,0.012075606d0,
     $ 0.345409022d0,0.006236851d0,0.39738467d0,
     $ 0.003724836d0,0.48099804d0,0.002120409d0,
     $ 0.32263166d0,0.005342104d0,0.168555736d0,
     $ 0.000578546d0,0.093384689d0,0.000762242d0,
     $ 0.055673903d0,0.002113132d0,1.40829d-05 /)

      tC11i = (/ 2.03d-10,1.03d-09,2.34d-09,
     $ 5.30d-09,2.72d-08,1.40d-07,
     $ 5.59d-07,1.64d-06,8.46d-06,
     $ 4.34177d-05,0.00022114d0,0.001114722d0,
     $ 0.002521545d0,0.005730159d0,0.013071738d0,
     $ 0.029196671d0,0.065513882d0,0.147683961d0,
     $ 0.333682425d0,0.753934007d0,1.703465465d0,
     $ 3.848870805d0,4.851022995d0,19.69397278d0,
     $ 44.51434629d0,100.6931669d0,227.7718242d0,
     $ 515.2286446d0,629.5061829d0,11981.19123d0 /)

      C12g = 2.277211267d0

      C12i = (/ 0.018482475d0,0.01526789d0,0.041019674d0,
     $ 0.085151471d0,0.126091309d0,0.166847162d0,
     $ 0.014151559d0,0.22609683d0,0.270689575d0,
     $ 0.293302276d0,0.288925407d0,0.255609952d0,
     $ 0.201667483d0,0.138530108d0,0.075399258d0,
     $ 0.022703377d0,0.012298431d0,0.000179286d0,
     $ 0.011888383d0,0.000119802d0,0.008067189d0,
     $ 0.000179789d0,0.004276925d0,0.000265656d0 /)

      tC12i = (/ 2.04d-10,1.02d-09,2.33d-09,
     $ 1.20d-08,6.19d-08,3.05d-07,
     $ 5.57d-07,1.64d-06,8.43d-06,
     $ 4.32182d-05,0.000220631d0,0.001121158d0,
     $ 0.005690713d0,0.028895708d0,0.147005415d0,
     $ 0.761786608d0,3.884483968d0,8.766643242d0,
     $ 19.80766733d0,44.61696246d0,100.8091609d0,
     $ 228.2968925d0,518.203092d0,770.0164444d0 /)

      C13g = 2.442616822d0

      C13i = (/ 0.017093248d0,0.018755341d0,0.034182521d0,
     $ 0.010919361d0,0.077944413d0,0.006743439d0,
     $ 0.128376758d0,0.175837229d0,0.013750015d0,
     $ 0.237647195d0,0.287080845d0,0.310892236d0,
     $ 0.007283118d0,0.307929574d0,0.286394567d0,
     $ 0.224753531d0,0.166535644d0,0.047381188d0,
     $ 0.023305627d0,0.027960832d0,0.031492018d0,
     $ 0.000358123d0 /)

      tC13i = (/ 2.05d-10,1.02d-09,2.33d-09,
     $ 5.29d-09,1.20d-08,2.72d-08,
     $ 6.19d-08,3.06d-07,5.58d-07,
     $ 1.65d-06,8.48d-06,4.35178d-05,
     $ 9.87795d-05,0.0002237d0,0.00112763d0,
     $ 0.005763239d0,0.029365225d0,0.149566156d0,
     $ 28.90679882d0,131.0690042d0,638.2634862d0,
     $ 12147.8662d0 /)

      C22g = 4.84154319d0

      C22i = (/ 0.111629663d0,0.032419826d0,0.054609852d0,
     $ 0.091406722d0,0.162275087d0,0.205053005d0,
     $ 0.159635445d0,0.257183733d0,0.356417155d0,
     $ 0.380611636d0,0.399201819d0,0.3795247d0,
     $ 0.01562039d0,0.351647068d0,0.01165553d0,
     $ 0.343729206d0,0.006117279d0,0.39492685d0,
     $ 0.003666111d0,0.477622449d0,0.002069025d0,
     $ 0.320570403d0,0.005090104d0,0.167381027d0,
     $ 0.000577162d0,0.09274193d0,0.000758785d0,
     $ 0.055284857d0,0.002102359d0,1.40131d-05 /)

      tC22i = (/ 2.03d-10,1.03d-09,2.34d-09,
     $ 5.30d-09,2.72d-08,1.40d-07,
     $ 5.59d-07,1.64d-06,8.46d-06,
     $ 4.33677d-05,0.000220885d0,0.00111344d0,
     $ 0.002524449d0,0.00573676d0,0.013071738d0,
     $ 0.029196671d0,0.065513882d0,0.147683961d0,
     $ 0.333682425d0,0.753934007d0,1.703465465d0,
     $ 3.848870805d0,4.890275579d0,19.69397278d0,
     $ 44.51434629d0,100.6931669d0,227.7718242d0,
     $ 515.2286446d0,629.5061829d0,11967.40531d0 /)

      C23g = 2.434060508d0

      C23i = (/ 0.016923061d0,0.018779522d0,0.033914932d0,
     $ 0.011051882d0,0.07754026d0,0.006907319d0,
     $ 0.127888164d0,0.175698345d0,0.013239713d0,
     $ 0.237425725d0,0.285749218d0,0.312581254d0,
     $ 0.001111412d0,0.313535678d0,0.000298019d0,
     $ 0.283620188d0,0.221449545d0,0.167125445d0,
     $ 0.046434177d0,0.019112143d0,0.035613559d0,
     $ 0.010451321d0,0.017609625d0 /)

      tC23i = (/ 2.04d-10,1.02d-09,2.33d-09,
     $ 5.29d-09,1.20d-08,2.72d-08,
     $ 6.19d-08,3.06d-07,5.57d-07,
     $ 1.65d-06,8.48d-06,4.35178d-05,
     $ 9.86658d-05,0.000223443d0,0.000507185d0,
     $ 0.001147273d0,0.005730159d0,0.029365225d0,
     $ 0.149394061d0,22.50781482d0,131.2199899d0,
     $ 638.2634862d0,821.2965528d0 /)

      C33g = 15.00815259d0

      C33i = (/ 0.147622377d0,0.034001481d0,0.073197303d0,
     $ 0.101455076d0,0.181267394d0,0.219473243d0,
     $ 0.170513387d0,0.268807745d0,0.372168629d0,
     $ 0.398841283d0,0.42417187d0,0.420548134d0,
     $ 0.009737689d0,0.421510204d0,0.009819918d0,
     $ 0.478134707d0,0.00257313d0,0.701284161d0,
     $ 0.032857687d0,0.448307384d0,0.962641787d0,
     $ 0.480329115d0,1.558484666d0,0.090118457d0,
     $ 0.209613897d0,1.97779607d0,0.031605394d0,
     $ 2.161674926d0,0.102070153d0,1.847944087d0,
     $ 0.669581237d0 /)


      tC33i = (/ 2.05d-10,1.04d-09,2.35d-09,
     $ 5.31d-09,2.72d-08,1.40d-07,
     $ 5.59d-07,1.65d-06,8.44d-06,
     $ 4.33677d-05,0.000221394d0,0.001125037d0,
     $ 0.002544876d0,0.005783179d0,0.013238334d0,
     $ 0.030014653d0,0.068443677d0,0.158976647d0,
     $ 0.346603811d0,0.772384115d0,1.101116659d0,
     $ 4.138408271d0,6.058056694d0,12.83315186d0,
     $ 24.36875453d0,27.97907377d0,58.14334323d0,
     $ 129.7179271d0,269.1534804d0,629.5061829d0,
     $ 816.5823714d0 /)

      C1212g = 1.450478496d0

      C1212i = (/ 0.028311823d0,0.002937854d0,0.027933715d0,
     $ 0.001188386d0,0.028641955d0,0.000161034d0,
     $ 0.029218476d0,0.029697524d0,0.029975455d0,
     $ 0.002464522d0,0.035061928d0,0.040758331d0,
     $ 0.046481342d0,0.00345388d0,0.0152572d0,
     $ 0.040724407d0,0.051505564d0,0.01637192d0,
     $ 0.004083016d0,0.084096912d0,0.116749302d0,
     $ 0.001158855d0,0.185019738d0,0.001935467d0,
     $ 0.268749445d0,0.000676407d0,0.182891211d0,
     $ 0.002292043d0,0.091463627d0,0.000128758d0,
     $ 0.049792337d0,0.000155062d0,0.030861595d0,
     $ 0.000273302d0,6.10d-06 /)


      tC1212i = (/ 8.65d-11,1.95d-10,4.57d-10,
     $ 1.04d-09,2.34d-09,5.30d-09,
     $ 1.20d-08,6.18d-08,3.07d-07,
     $ 5.56d-07,1.65d-06,8.49d-06,
     $ 4.31685d-05,9.6309d-05,0.000216854d0,
     $ 0.000237502d0,0.001121158d0,0.001256512d0,
     $ 0.002852113d0,0.005974937d0,0.029297687d0,
     $ 0.065287995d0,0.147344298d0,0.33329848d0,
     $ 0.753934007d0,1.703465465d0,3.848870805d0,
     $ 4.718819151d0,19.69397278d0,44.51434629d0,
     $ 100.6931669d0,227.7718242d0,515.2286446d0,
     $ 770.0164444d0,11428.78335d0 /)

      C1313g = 1.655760734d0

      C1313i = (/ 0.031813108d0,0.003004202d0,0.030410365d0,
     $ 0.00158462d0,0.029277273d0,0.001054225d0,
     $ 0.027594965d0,0.000836801d0,0.026269834d0,
     $ 0.024854295d0,
     $ 0.001532461d0,0.026005942d0,0.027682951d0,
     $ 0.03078816d0,0.036669323d0,1.87714d-05,
     $ 0.047325952d0,0.067976293d0,4.95863d-05,
     $ 0.112324111d0,0.000351959d0,0.214283214d0,
     $ 0.000426149d0,0.33330826d0,0.011030417d0,
     $ 0.00760226d0,0.210993567d0,0.042137897d0,
     $ 0.00038119d0,0.115698659d0,0.022964099d0,
     $ 0.020157675d0,0.076878832d0,0.046973566d0,
     $ 0.025489539d0,1.02134d-05 /)


      tC1313i = (/ 8.68d-11,1.95d-10,4.57d-10,
     $ 1.04d-09,2.34d-09,5.30d-09,
     $ 1.20d-08,2.73d-08,6.16d-08,
     $ 3.04d-07,5.44d-07,1.61d-06,
     $ 8.22d-06,4.20404d-05,0.000215113d0,
     $ 0.000486594d0,0.001100694d0,0.005625572d0,
     $ 0.012340516d0,0.028796077d0,0.065287995d0,
     $ 0.148024408d0,0.334836916d0,0.757414009d0,
     $ 0.90538508d0,1.711328304d0,3.866636385d0,
     $ 4.845441263d0,8.776742025d0,19.63360277d0,
     $ 24.93637575d0,63.16841793d0,118.9871329d0,
     $ 524.203601d0,721.1074792d0,5895.219771d0 /)

      C2323g = 1.651265128d0

      C2323i = (/ 0.031726704d0,0.002996061d0,0.030327794d0,
     $ 0.001580284d0,0.029197675d0,0.001051707d0,
     $ 0.027519419d0,0.000835289d0,0.02619782d0,
     $ 0.024789609d0,0.001526375d0,0.025934557d0,
     $ 0.027608022d0,0.030704223d0,0.036571044d0,
     $ 1.57751d-05,0.047200739d0,0.067782377d0,
     $ 7.33664d-05,0.111972011d0,0.000439401d0,
     $ 0.21352458d0,0.000894734d0,0.3278341d0,
     $ 0.016911015d0,0.003855124d0,0.001271605d0,
     $ 0.219304979d0,0.030118704d0,0.007049218d0,
     $ 0.099422246d0,0.038612336d0,0.003695995d0,
     $ 0.062851191d0,0.006875753d0,0.020241141d0,
     $ 0.000721514d0,0.040191293d0,0.016305387d0,
     $ 0.015533961d0 /)


      tC2323i = (/8.68d-11,1.95d-10,4.57d-10,
     $ 1.04d-09,2.34d-09,5.30d-09,
     $ 1.20d-08,2.73d-08,6.16d-08,
     $ 3.04d-07,5.45d-07,1.61d-06,
     $ 8.22d-06,4.20404d-05,0.000215113d0,
     $ 0.000486594d0,0.001100694d0,0.005625572d0,
     $ 0.012340516d0,0.028796077d0,0.065287995d0,
     $ 0.148024408d0,0.334836916d0,0.757414009d0,
     $ 0.906428043d0,1.711328304d0,2.563500068d0,
     $ 3.866636385d0,4.839865952d0,8.776742025d0,
     $ 19.56590768d0,24.93637575d0,44.51434629d0,
     $ 101.5079367d0,119.2614266d0,139.4761658d0,
     $ 303.0400298d0,525.4120151d0,590.8809656d0,
     $ 776.2471166d0 /)

C TTS COEFFICIENTS -------------------------------------------------------

      Tref = 214.92814566484793d0
      b1 = -1.38048569226571d0
      b2 = -0.0839363492674589d0
      b3 = -0.000178506624359254d0
      b4 = 1.11572814246203d-06
      b5 = 1.12274107192737d-08
      b6 = 11289.1761172407d0
      b7 = -1057.29768217945d0
      b8 = 7240.74915864856d0
      b9 = 8.68153060395207d0

C PRONY SERIES LENGTHS ---------------------------------------------------

      NC11 = 30
      NC12 = 24
      NC13 = 22
      NC22 = 30
      NC23 = 23
      NC33 = 31
      NC1212 = 35
      NC1313 = 36
      NC2323 = 40

C TEMPERATURE VARIABLES --------------------------------------------------

      Tinit = 230d0
      Theta = temp - Tinit
      Thetap = temp + dtemp - Tinit

C SHIFT FACTOR VALUES COMPUTATION ----------------------------------------

      DelTr = temp - Tref
      DelTrm = temp + (0.5d0*dtemp) - Tref
      DelTrp = temp + dtemp - Tref
      aT = 10**(b1 + b2*DelTr + b3*DelTr**2.0d0 + b4*DelTr**3.0d0 + 
     $       b5*DelTr**4.0d0 +(b6 + b7*DelTr)/(b8 + b9*DelTr**2.0d0))
      aTm = 10**(b1 + b2*DelTrm + b3*DelTrm**2.0d0 + b4*DelTrm**3.0d0 + 
     $      b5*DelTrm**4.0d0 +(b6 + b7*DelTrm)/(b8 + b9*DelTrm**2.0d0))
      aTp = 10**(b1 + b2*DelTrp + b3*DelTrp**2.0d0 + b4*DelTrp**3.0d0 + 
     $       b5*DelTrp**4.0d0 +(b6 + b7*DelTrp)/(b8 + b9*DelTrp**2.0d0))

C MODE SELECTOR AND INTERNAL TIME COMPUTATION ----------------------------

      ThMode = 1
      if (ThMode.EQ.0) DeltXi = dtime
      if (ThMode.EQ.1) DeltXi = dtime*((1.0d0/6.0d0)*(1/aT) + 
     $      (2.0d0/3.0d0)*(1/aTm) + (1.0d0/6.0d0)*(1/aTp))

C LOCAL STORAGE OF STRAIN VARIABLES --------------------------------------

      eps = STRAN 
      epsp = STRAN + DSTRAN
      deps = DSTRAN

C COMPUTATION OF INSTANTANEOUS PART OF THE STRESS -----------------------

      Lg = reshape((/ C11g,C12g,C13g,0.0d0,0.0d0,0.0d0,
     $                C12g,C22g,C23g,0.0d0,0.0d0,0.0d0,
     $                C13g,C23g,C33g,0.0d0,0.0d0,0.0d0,
     $                0.0d0,0.0d0,0.0d0,C1212g,0.0d0,0.0d0,
     $                0.0d0,0.0d0,0.0d0,0.0d0,C1313g,0.0d0,
     $                0.0d0,0.0d0,0.0d0,0.0d0,0.0d0,C2323g /),shape(Lg))
      dsigg = matmul(Lg,deps)
      STRESS = STRESS + dsigg

C INTERNAL VARIABLES HANDLER ---------------------------------------------

C LOCAL STORAGE OF INTERNAL VARIABLES STATEV

      do i=1,NC11
        qC11(i)=statev(i)
      enddo

      do i=1,NC12
        qC121(i)=statev(i+NC11)
      enddo

      do i=1,NC12
        qC122(i)=statev(i+NC11+NC12)
      enddo

      do i=1,NC13
        qC131(i)=statev(i+NC11+NC12+NC12)
      enddo

      do i=1,NC13
        qC132(i)=statev(i+NC11+NC12+NC12+NC13)
      enddo

      do i=1,NC22
        qC22(i)=statev(i+NC11+NC12+NC12+NC13+NC13)
      enddo

      do i=1,NC23
        qC231(i)=statev(i+NC11+NC12+NC12+NC13+NC13+NC22)
      enddo

      do i=1,NC23
        qC232(i)=statev(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23)
      enddo

      do i=1,NC33
        qC33(i)=statev(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23)
      enddo

      do i=1,NC1212
        qC1212(i)=statev(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23+NC33)
      enddo

      do i=1,NC1313
        qC1313(i)=statev(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23+NC33+
     $                    NC1212)
      enddo

      do i=1,NC2323
        qC2323(i)=statev(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23+NC33+
     $                    NC1212+NC1313)
      enddo

C UPDATING LOCAL AND GLOBAL INTERNAL VARIABLES
C COMPUTING THE DISSIPATIVE PART OF THE STRESS
C COMPUTING CONTRIBUTIONS FOR DDSDDE MATRIX

      svC11=0.0d0
      C11tot=0.0d0
      do i=1,NC11
        scal=DeltXi/tC11i(i)
        qC11p(i)=qC11(i)*exp(-scal)+eps(1)*(1.0d0-exp(-scal))+
     $   (epsp(1)-eps(1))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i)=qC11p(i) 
        svC11=svC11+C11i(i)*(qC11p(i)-qC11(i))
        C11tot=C11tot+C11i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC121=0.0d0
      C12tot=0.0d0
      do i=1,NC12
        scal=DeltXi/tC12i(i)
        qC121p(i)=qC121(i)*exp(-scal)+eps(2)*(1.0d0-exp(-scal))+
     $   (epsp(2)-eps(2))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11)=qC121p(i) 
        svC121=svC121+C12i(i)*(qC121p(i)-qC121(i))
        C12tot=C12tot+C12i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC122=0.0d0
      do i=1,NC12
        scal=DeltXi/tC12i(i)
        qC122p(i)=qC122(i)*exp(-scal)+eps(1)*(1.0d0-exp(-scal))+
     $   (epsp(1)-eps(1))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12)=qC122p(i) 
        svC122=svC122+C12i(i)*(qC122p(i)-qC122(i))
      enddo

      svC131=0.0d0
      C13tot=0.0d0
      do i=1,NC13
        scal=DeltXi/tC13i(i)
        qC131p(i)=qC131(i)*exp(-scal)+eps(3)*(1.0d0-exp(-scal))+
     $   (epsp(3)-eps(3))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12)=qC131p(i) 
        svC131=svC131+C13i(i)*(qC131p(i)-qC131(i))
        C13tot=C13tot+C13i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC132=0.0d0
      do i=1,NC13
        scal=DeltXi/tC13i(i)
        qC132p(i)=qC132(i)*exp(-scal)+eps(1)*(1.0d0-exp(-scal))+
     $   (epsp(1)-eps(1))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13)=qC132p(i) 
        svC132=svC132+C13i(i)*(qC132p(i)-qC132(i))
      enddo

      svC22=0.0d0
      C22tot=0.0d0
      do i=1,NC22
        scal=DeltXi/tC22i(i)
        qC22p(i)=qC22(i)*exp(-scal)+eps(2)*(1.0d0-exp(-scal))+
     $   (epsp(2)-eps(2))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13)=qC22p(i) 
        svC22=svC22+C22i(i)*(qC22p(i)-qC22(i))
        C22tot=C22tot+C22i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC231=0.0d0
      C23tot=0.0d0
      do i=1,NC23
        scal=DeltXi/tC23i(i)
        qC231p(i)=qC231(i)*exp(-scal)+eps(3)*(1.0d0-exp(-scal))+
     $   (epsp(3)-eps(3))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13+NC22)=qC231p(i) 
        svC231=svC231+C23i(i)*(qC231p(i)-qC231(i))
        C23tot=C23tot+C23i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC232=0.0d0
      do i=1,NC23
        scal=DeltXi/tC23i(i)
        qC232p(i)=qC232(i)*exp(-scal)+eps(2)*(1.0d0-exp(-scal))+
     $   (epsp(2)-eps(2))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23)=qC232p(i) 
        svC232=svC232+C23i(i)*(qC232p(i)-qC232(i))
      enddo

      svC33=0.0d0
      C33tot=0.0d0
      do i=1,NC33
        scal=DeltXi/tC33i(i)
        qC33p(i)=qC33(i)*exp(-scal)+eps(3)*(1.0d0-exp(-scal))+
     $   (epsp(3)-eps(3))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23)=qC33p(i) 
        svC33=svC33+C33i(i)*(qC33p(i)-qC33(i))
        C33tot=C33tot+C33i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC1212=0.0d0
      C1212tot=0.0d0
      do i=1,NC1212
        scal=DeltXi/tC1212i(i)
        qC1212p(i)=qC1212(i)*exp(-scal)+eps(4)*(1.0d0-exp(-scal))+
     $   (epsp(4)-eps(4))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23+NC33)=qC1212p(i) 
        svC1212=svC1212+C1212i(i)*(qC1212p(i)-qC1212(i))
        C1212tot=C1212tot+C1212i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC1313=0.0d0
      C1313tot=0.0d0
      do i=1,NC1313
        scal=DeltXi/tC1313i(i)
        qC1313p(i)=qC1313(i)*exp(-scal)+eps(5)*(1.0d0-exp(-scal))+
     $   (epsp(5)-eps(5))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23+NC33+
     $          NC1212)=qC1313p(i) 
        svC1313=svC1313+C1313i(i)*(qC1313p(i)-qC1313(i))
        C1313tot=C1313tot+C1313i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      svC2323=0.0d0
      C2323tot=0.0d0
      do i=1,NC2323
        scal=DeltXi/tC2323i(i)
        qC2323p(i)=qC2323(i)*exp(-scal)+eps(6)*(1.0d0-exp(-scal))+
     $   (epsp(6)-eps(6))*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(i+NC11+NC12+NC12+NC13+NC13+NC22+NC23+NC23+NC33+
     $          NC1212+NC1313)=qC2323p(i) 
        svC2323=svC2323+C2323i(i)*(qC2323p(i)-qC2323(i))
        C2323tot=C2323tot+C2323i(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

C UPDATING STRESS ELEMENTS -----------------------------------------------

      STRESS(1)=STRESS(1)-svC11-svC121-svC131
      STRESS(2)=STRESS(2)-svC122-svC22-svC231
      STRESS(3)=STRESS(3)-svC132-svC232-svC33
      STRESS(4)=STRESS(4)-svC1212
      STRESS(5)=STRESS(5)-svCl313
      STRESS(6)=STRESS(6)-svC2323

C UPDATING DDSDDE --------------------------------------------------------
        
      LVISC = reshape((/ C11tot,C12tot,C13tot,0.0d0,0.0d0,0.0d0,
     $                   C12tot,C22tot,C23tot,0.0d0,0.0d0,0.0d0,
     $                   C13tot,C23tot,C33tot,0.0d0,0.0d0,0.0d0,
     $                   0.0d0,0.0d0,0.0d0,C1212tot,0.0d0,0.0d0,
     $                   0.0d0,0.0d0,0.0d0,0.0d0,C1313tot,0.0d0,
     $                   0.0d0,0.0d0,0.0d0,0.0d0,0.0d0,C2323tot
     $                                                      /),(/6,6/))
     
      DDSDDE = Lg-LVISC

      RETURN
      END

      SUBROUTINE UEXPAN(EXPAN,DEXPANDT,TEMP,TIME,DTIME,PREDEF,DPRED,
     1     STATEV,CMNAME,NSTATV,NOEL)
C
      INCLUDE 'ABA_PARAM.INC'
C
      CHARACTER*80 CMNAME
C
      DIMENSION EXPAN(*),DEXPANDT(*),TEMP(2),TIME(2),PREDEF(*),
     1     DPRED(*),STATEV(NSTATV)

C LOCAL VARIABLES --------------------------------------------------------

      real(kind=8) altg,allg,alti(133),alli(135),talti(133),talli(135) 
      real(kind=8) Tref,b1,b2,b3,b4,b5,b6,b7,b8,b9,DelTr,DelTrp,DeltXi
      real(kind=8) aT,aTm,aTp,Theta,Thetap,Tinit
      real(kind=8) exptg,explg,exptgp,explgp
      real(kind=8) exptv,explv,alttot,alltot
      real(kind=8) expt,expl,expp(3),exptp,explp,exppp(3)
      real(kind=8) qalt(133),qall(135),qaltp(133),qallp(135)

      integer NmecSttv, Nalt, Nall, ThMode

C THERMOMECHANICAL PROPERTIES --------------------------------------------


      altg = 5.780519431405963d-05

      alti = (/ -6.088691089575771d-07, -6.189063379014037d-07,
     $ -6.375878695702442d-07,
     $ -6.660310815642667d-07, -1.4527564928812353d-08, -6.857604990528898d-07,
     $ -7.435206935690886d-07, -7.9359266846879d-07, -8.487655467348532d-07,
     $ -1.223272647621343d-07, -4.047433321829885d-08, -9.020041034091264d-07,
     $ -2.0614243112504482d-07, 2.0542938727885485d-07, -1.1050578905269504d-06,
     $ 8.41217115521431d-07, -1.760898157954216d-06, -1.7436104826629162d-07,
     $ -1.300446456298232d-06, 8.12142388895154d-08, 1.0260555427521467d-07,
     $ 6.433401722460985d-08, -1.0517833288758993d-06, 2.2193999029695988d-06,
     $ -1.9319995772093534d-06, -2.007000148296356d-06, 1.8423452274873853d-06,
     $ -1.3185517673264258d-06, 3.509640009724535d-07, 2.967876753245946d-07,
     $ -2.1479372662724927d-06, 6.665322871413082d-07, 5.879301170352846d-07,
     $ -3.677996573969722d-09, 3.001769073307514d-07, 9.596988093107939d-08,
     $ -1.8488935893401504d-06, 2.7690111892297864d-07, 2.6789348339661956d-07,
     $ 8.441420504823327d-07, 2.147135091945529d-07, 1.64181983564049d-07,
     $ -1.8087448552250862d-06, 3.5937409847974777d-07, -3.734021447598934d-08,
     $ 1.5902332961559296d-07, 1.1432566680014133d-06, 1.139589585363865d-06,
     $ -2.416782081127167d-07, -3.024761099368334d-07, -1.5223922673612833d-06,
     $ 5.930196493864059d-07, -2.945307642221451d-07, -3.291643224656582d-07,
     $ 7.17060174793005d-07, 1.4986144378781319d-06, 1.0917428880929947d-06,
     $ -1.5774276107549667d-07, -1.827138476073742d-07, -1.2960517778992653d-06,
     $ 2.0059815142303705d-08, 1.0084477253258228d-08, 3.506997018121183d-06,
     $ 4.045286914333701d-07, 3.608874976634979d-08, -1.239714038092643d-06,
     $ -1.2967211659997702d-07, 4.374393029138446d-06, -2.544670678616967d-07,
     $ 6.981736078159884d-09, 4.774659601025633d-06, -3.8111102185212076d-07,
     $ -6.269983714446425d-07, 6.051850505173206d-07, 4.263246410118882d-06,
     $ -4.7370485845021904d-07, -1.6648846212774515d-07, -3.73147486243397d-08,
     $ 6.72000169288367d-07, -2.435990609228611d-08, -4.7541107051074505d-07,
     $ -1.8961145542562008d-08, -2.812157617881894d-08, -1.7022830434143543d-06,
     $ -3.3032847568392754d-08, -2.0037987269461155d-08, -5.777692422270775d-07,
     $ -1.605367287993431d-07, 2.1685264073312283d-07, -1.9441358745098114d-07,
     $ -5.953479558229446d-07, -3.4854747354984283d-07, 4.912726581096649d-08,
     $ 5.3085386753082275d-08, -5.036708898842335d-07, -2.0864536054432392d-07,
     $ -1.751177478581667d-07, 1.9883736968040466d-07, 1.9776052795350552d-07,
     $ 1.8958235159516335d-07, -1.5244586393237114d-07, -1.519802026450634d-07,
     $ 2.7030182536691427d-08, 5.311449058353901d-08, 1.9959406927227974d-07,
     $ 1.5328987501561642d-07, 1.2590317055583d-07, -1.5954719856381416d-07,
     $ -3.775348886847496d-07, -4.193279892206192d-07, 2.6222551241517067d-07,
     $ 4.0490704122930765d-08, -5.652200343320146d-07, -1.7627371562412009d-07,
     $ -4.6755303628742695d-08, -8.770439308136702d-08, -7.880735211074352d-07,
     $ -3.547145752236247d-06, -3.798952093347907d-06, 1.750304363667965d-07,
     $ 1.6413105186074972d-07, -2.56011844612658d-07, -6.401662631105864d-07,
     $ -5.346263485250802d-07, -4.751019213600216d-07, -4.237533293149909d-07,
     $ -2.18506102100946d-07, -1.5786554286023602d-07, -3.341786039001704d-07,
     $ -2.966934440351565d-07, -2.6273581005265d-07, -2.337408243346939d-07,
     $ -2.086406042430683d-07 /)


      talti = (/ 1.0935033847070227d-16, 4.96386694266375d-16,
     $ 2.2481233252960005d-15,
     $ 1.0205167367138971d-14, 4.459848762481597d-14, 4.632550172824962d-14, 
     $ 2.0980707620545198d-13, 9.524016335735564d-13, 4.323347372446729d-12, 
     $ 1.4315948639971032d-11, 1.674249321631786d-11, 1.9580335620638038d-11, 
     $ 7.342097232644826d-11, 8.078302870502852d-11, 8.888329206185992d-11, 
     $ 3.7395567788896193d-10, 3.884365888832151d-10, 4.034782529175287d-10, 
     $ 1.8273432429008998d-09, 1.906865808686213d-09, 1.9090624333150763d-09, 
     $ 1.992141265675309d-09, 7.325210877601144d-09, 8.295071458572595d-09, 
     $ 9.339424844723895d-09, 9.371737845814222d-09, 1.0551644034962706d-08, 
     $ 3.554840600162313d-08, 4.288645329736501d-08, 9.723444320629345d-08, 
     $ 1.7171970417567542d-07, 2.212178319211916d-07, 2.2403719762232213d-07, 
     $ 2.886158193995422d-07, 4.7024060950473644d-07, 4.7568573913364417d-07, 
     $ 7.750328875537399d-07, 1.088479193029602d-06, 1.0935033847070228d-06, 
     $ 1.5357486125754984d-06, 2.319103501635387d-06, 2.3271272499092668d-06, 
     $ 3.5141486763025783d-06, 4.745916922931149d-06, 5.355747967372048d-06, 
     $ 7.2330277556863966d-06, 8.162442438317629d-06, 1.0065147221642234d-05, 
     $ 1.135847775024208d-05, 1.1410906101419032d-05, 1.5878889688045857d-05,
     $ 2.31110741860257d-05, 2.608075333083268d-05, 2.62011366185104d-05, 
     $ 3.813468221297965d-05, 4.303483395625975d-05, 4.929695922985524d-05, 
     $ 5.563141822336336d-05, 5.575966188697935d-05, 7.208088855601777d-05, 
     $ 0.0001271511029213974d0, 0.0001280324722609902d0, 
     $ 0.00022585001910855338d0, 
     $ 0.0002693519547326705d0, 0.0002749920456004269d0, 
     $ 0.0003279594365799439d0, 
     $ 0.001133235397634359d0, 0.0011582975337448888d0, 
     $ 0.0018570351820241362d0, 
     $ 0.004368377199288104d0, 0.006135078607745312d0, 
     $ 0.027028387186372106d0, 
     $ 0.02909511858664794d0, 0.03081911274738182d0, 0.03317570278749234d0, 
     $ 0.1423377615348431d0, 0.16531799583178075d0, 0.16955872086888812d0, 
     $ 0.19693374131771169d0, 0.3522249625642596d0, 0.6256336964282874d0, 
     $ 0.8478521614096575d0, 0.8498066624965684d0, 1.15164899156072d0, 
     $ 1.8064258177701285d0, 1.8126757785963754d0, 2.8432832830995602d0, 
     $ 3.5589356184789764d0, 4.205524153971d0, 5.264051526242862d0, 
     $ 6.220426052782511d0, 7.565195083450034d0, 8.939642090673496d0, 
     $ 8.970571903742902d0, 12.891995096098123d0, 16.7232288002853d0, 
     $ 16.916874663256014d0, 21.91896946474353d0, 21.94421914300939d0, 
     $ 22.147266502781456d0, 28.728975016365435d0, 28.762069518241464d0, 
     $ 34.105163167342d0, 34.579613247775285d0, 37.65478148133399d0, 
     $ 44.701297756705465d0, 45.271004568298224d0, 49.98274824534714d0, 
     $ 53.74278047413011d0, 64.91127379376088d0, 92.5380048307762d0, 
     $ 176.93759978895596d0, 266.8825211684406d0, 1211.49083114884d0, 
     $ 1485.3203513361148d0, 1488.7443683678953d0, 1544.6145860707302d0, 
     $ 1825.2406468292913d0, 1893.7390367914393d0, 3157.3311303896617d0, 
     $ 3160.968235471148d0, 3275.8207659260806d0, 5467.894564677285d0, 
     $ 24821.048983624634d0, 112413.93015352837d0, 510293.61187895696d0, 
     $ 2313769.7115927306d0, 2316435.0714260507d0, 10491078.378527286d0, 
     $ 47623370.79552668d0, 216182299.2925341d0, 979084401.6758906d0, 
     $ 4444471561.337507d0 /)

      allg = 2.938437381950625d-05

      alli = (/ -1.2449297373106488d-07, -1.2654528636427131d-07, 
     $ -1.3036549226241867d-07, 
     $ -1.3618260633063706d-07, -2.986920932812609d-09, -1.4020839866901724d-07, 
     $ -1.5207730946764642d-07, -1.6252233847602326d-07, -1.7518859074527882d-07, 
     $ 1.2401801541273016d-07, -1.20776348921936d-08, -1.7085596937249647d-07, 
     $ 8.481038094032556d-08, 7.251219358295202d-08, -2.1844061848241836d-07, 
     $ 4.113899194635451d-07, -6.156042218208313d-07, 1.5116529539227486d-07, 
     $ -1.0944222594844177d-07, -2.0768766262335703d-07, -1.9452727428870276d-07, 
     $ 4.7193316277116537d-07, -5.480906111188233d-07, 2.913820935646072d-07, 
     $ 3.1747458706377074d-07, -8.57162376632914d-08, -6.066229616408236d-07, 
     $ 7.348417057073675d-07, -1.9758772396016866d-07, 2.565138856880367d-07, 
     $ -4.81042661704123d-07, -2.764118107734248d-07, 8.458737283945084d-07, 
     $ -2.0797597244381905d-07, -4.2637111619114876d-08, 8.370989235118032d-08, 
     $ -2.6565976440906525d-07, -8.707775123184547d-08, -4.288085619919002d-08, 
     $ 4.2992178350687027d-07, 2.784945536404848d-07, -2.19675712287426d-07, 
     $ 5.0640664994716644d-09, 2.5582266971468925d-08, -1.6952981241047382d-08, 
     $ -3.753521014004946d-07, -2.2107087715994567d-08, 1.6740523278713226d-07, 
     $ 5.754409357905388d-07, 9.16188582777977d-08, -2.15193722397089d-07, 
     $ -7.945345714688301d-08, 2.4365726858377457d-07, -1.4769466361030936d-07, 
     $ -4.051835276186466d-07, -1.9885192159563303d-08, 4.306202754378319d-07, 
     $ 5.113397492095828d-07, -8.702045306563377d-09, -9.262294042855501d-08, 
     $ 6.880145519971848d-08, 2.0622974261641502d-07, -2.2400854504667222d-07, 
     $ -3.9761653169989586d-07, 6.32571754977107d-08, 4.5236083678901196d-07, 
     $ 2.0102379494346678d-07, 7.404014468193054d-08, -6.999471224844456d-09, 
     $ 1.5757541405037045d-07, 3.00715328194201d-07, 3.110762918367982d-07, 
     $ -4.963367246091366d-07, -2.6091584004461765d-08, 1.2661257642321289d-07, 
     $ -3.5388802643865347d-07, 1.2910677469335496d-06, 7.574708433821797d-07, 
     $ 2.3039319785311818d-08, 4.551948222797364d-07, 1.1013398761861026d-06, 
     $ -6.417394615709782d-09, -1.2687451089732349d-08, 2.949964255094528d-07, 
     $ 9.940704330801964d-07, 3.082677721977234d-07, 6.298068910837173d-08, 
     $ -8.079223334789276d-08, -8.66129994392395d-08, 1.266016624867916d-07, 
     $ 9.06948116607964d-07, 7.136259227991104d-08, -3.710738383233547d-10, 
     $ -4.3190084397792816d-08, -1.3969838619232178d-08, 6.868503987789154d-08, 
     $ 1.3882527127861977d-08, -4.901085048913956d-08, -2.403976395726204d-08, 
     $ 1.4237593859434128d-07, 2.096639946103096d-07, 2.050073817372322d-07, 
     $ 5.273614078760147d-08, 4.7963112592697144d-08, -7.450580596923828d-09, 
     $ 2.954038791358471d-07, 7.741618901491165d-09, 8.119968697428703d-08, 
     $ 1.4310353435575962d-07, 1.1746305972337723d-07, -1.6232661437243223d-08, 
     $ 1.760781742632389d-08, 1.1015799827873707d-08, -1.1026713764294982d-08, 
     $ 5.648871592711657d-09, 6.548361852765083d-10, 6.693881005048752d-10, 
     $ 4.220055416226387d-10, -1.0040821507573128d-09, 1.3536919141188264d-08, 
     $ 2.0270817913115025d-08, 7.683411240577698d-09, -2.990418579429388d-09, 
     $ -3.914465196430683d-09, 2.0834249880863354d-09, 1.5577938938804436d-09, 
     $ 1.3658372211011738d-09, 1.2140244365355102d-09, 7.121343514882028d-10, 
     $ 3.710738383233547d-10, 9.567594494441778d-10, 8.493696856959332d-10, 
     $ 7.521642197971801d-10, 6.691499299105175d-10, 5.972955012534253d-10 /)


      talli = (/ 1.0935033847070227d-16, 4.96386694266375d-16, 
     $ 2.2481233252960005d-15, 
     $ 1.0205167367138971d-14, 4.459848762481597d-14, 4.632550172824962d-14, 
     $ 2.0980707620545198d-13, 9.524016335735564d-13, 4.323347372446729d-12, 
     $ 1.4315948639971032d-11, 1.674249321631786d-11, 1.9580335620638038d-11, 
     $ 7.308363360096303d-11, 8.059723289478588d-11, 8.888329206185992d-11, 
     $ 3.7309560369662247d-10, 3.879896420662857d-10, 4.034782529175287d-10, 
     $ 1.823140470067934d-09, 1.869907534952078d-09, 1.8720615852928246d-09, 
     $ 1.9200835710168538d-09, 8.304627012078815d-09, 9.022359580504809d-09, 
     $ 9.064004900144701d-09, 9.847367176107836d-09, 4.547996603107771d-08, 
     $ 5.368094241522083d-08, 9.712256233273336d-08, 1.6897409598688093d-07, 
     $ 2.1297083401709896d-07, 2.2223892703918097d-07, 2.801045294319799d-07, 
     $ 4.4342495604039597d-07, 4.7459169229311486d-07, 7.513116646809364d-07, 
     $ 9.85871090526275d-07, 1.0466949567824073d-06, 1.0600348210920346d-06, 
     $ 1.390977585193808d-06, 1.4767947223632758d-06, 2.1346178249315695d-06, 
     $ 2.2559014928672633d-06, 2.2663142610470516d-06, 3.4619447424763833d-06, 
     $ 4.784319028746906d-06, 5.102936118789569d-06, 5.270115479551717d-06, 
     $ 7.052127111116482d-06, 7.76819522877754d-06, 1.0551644034962706d-05, 
     $ 1.087226756146614d-05, 1.1623050684799604d-05, 1.626747438806451d-05, 
     $ 2.3868225465015858d-05, 2.513738701823413d-05, 2.6749774891856414d-05, 
     $ 3.688248136371958d-05, 4.133520840829433d-05, 5.0329212104486995d-05, 
     $ 5.3495854827483025d-05, 5.640532834134713d-05, 7.299954137499251d-05,
     $ 0.0001142405095789808d0, 0.00012184848440430904d0, 
     $ 0.00012981358136943363d0, 
     $ 0.00018252406468292914d0, 0.00019068658086862127d0, 
     $ 0.0002166806509606318d0, 
     $ 0.00023676643316243042d0, 0.000256342214408007d0, 
     $ 0.00026904203027589387d0, 
     $ 0.0003182879020530507d0, 0.0005569550314368191d0, 
     $ 0.0005634042667481626d0, 
     $ 0.000985871090526275d0, 0.0010228692707545026d0, 
     $ 0.004670034959183956d0, 
     $ 0.005374278047413008d0, 0.006184721267258431d0, 0.02389572059952653d0, 
     $ 0.028010452943198004d0, 0.028042719739592523d0, 0.032871546116115445d0, 
     $ 0.12325942335610673d0, 0.13207485167852348d0, 0.13782250260398274d0, 
     $ 0.14598899929652537d0, 0.1476794722363278d0, 0.16323757395463553d0, 
     $ 0.6394699363550949d0, 0.778610276821547d0, 0.8143669341657418d0, 
     $ 0.9317944763646984d0, 0.9915625864434761d0, 1.1866431365247503d0, 
     $ 1.5111936904315444d0, 1.835777876076771d0, 2.1004876462883426d0, 
     $ 2.67497748918564d0, 3.249526863924421d0, 3.317570278749234d0, 
     $ 4.030139987097554d0, 4.048742268070571d0, 5.021345812878549d0, 
     $ 16.286213795277853d0, 17.291000830035085d0, 19.00291088184112d0, 
     $ 85.37291918278355d0, 86.16286507801587d0, 106.00348210920367d0, 
     $ 148.36112970859463d0, 151.29345183724817d0, 184.21293905969364d0, 
     $ 262.9178859871235d0, 1246.8670021096027d0, 1530.4534744261973d0, 
     $ 1533.9815340518994d0, 1587.8889688045858d0, 1882.8691147678555d0, 
     $ 1949.0372150344188d0, 3157.3311303896617d0, 3260.7697366754473d0, 
     $ 3268.286587235697d0, 5467.894564677285d0, 24821.048983624634d0, 
     $ 112413.93015352837d0, 510293.61187895696d0, 2313769.7115927306d0, 
     $ 2316435.0714260507d0, 10491078.378527286d0, 47623370.79552668d0, 
     $ 216182299.2925341d0, 979084401.6758906d0, 4444471561.337507d0 /)

C TTS COEFFICIENTS -------------------------------------------------------

      Tref = 214.92814566484793d0
      b1 = -1.38048569226571d0
      b2 = -0.0839363492674589d0
      b3 = -0.000178506624359254d0
      b4 = 1.11572814246203d-06
      b5 = 1.12274107192737d-08
      b6 = 11289.1761172407d0
      b7 = -1057.29768217945d0
      b8 = 7240.74915864856d0
      b9 = 8.68153060395207d0

C PRONY SERIES LENGTHS ---------------------------------------------------

      NmecSttv=340
      Nalt=133
      Nall=135

C SHIFT FACTOR VALUES COMPUTATION ----------------------------------------

      DelTr = temp(1) - temp(2) - Tref
      DelTrm = temp(1) - 0.5d0*temp(2) - Tref
      DelTrp = temp(1) - Tref
      aT = 10**(b1 + b2*DelTr + b3*DelTr**2.0d0 + b4*DelTr**3.0d0 + 
     $       b5*DelTr**4.0d0 +(b6 + b7*DelTr)/(b8 + b9*DelTr**2.0d0))
      aTm = 10**(b1 + b2*DelTrm + b3*DelTrm**2.0d0 + b4*DelTrm**3.0d0 + 
     $      b5*DelTrm**4.0d0 +(b6 + b7*DelTrm)/(b8 + b9*DelTrm**2.0d0))
      aTp = 10**(b1 + b2*DelTrp + b3*DelTrp**2.0d0 + b4*DelTrp**3.0d0 + 
     $       b5*DelTrp**4.0d0 +(b6 + b7*DelTrp)/(b8 + b9*DelTrp**2.0d0))

C MODE SELECTOR AND INTERNAL TIME COMPUTATION ----------------------------

      ThMode = 1
      if (ThMode.EQ.0) DeltXi = dtime
      if (ThMode.EQ.1) DeltXi = dtime*((1.0d0/6.0d0)*(1/aT) + 
     $      (2.0d0/3.0d0)*(1/aTm) + (1.0d0/6.0d0)*(1/aTp))

C LOCAL STORAGE OF STRAIN VARIABLES --------------------------------------
      Tinit = 230.0d0
      Theta = temp(1) - temp(2) - Tinit
      Thetap = temp(1) - Tinit

C COMPUTATION OF INSTANTANEOUS PART OF THE THERMAL STRAINS ---------------

      exptg = altg*(Theta)
      explg = allg*(Theta)
      exptgp = altg*(Thetap)
      explgp = allg*(Thetap)

C INTERNAL VARIABLES HANDLER ---------------------------------------------

C UPDATING LOCAL AND GLOBAL INTERNAL VARIABLES
C COMPUTING CONTRIBUTIONS FOR DDSDDE MATRIX
C COMPUTING CONTRIBUTIONS FOR DEXPANDT MATRIX

      do i=1,Nalt
        qalt(i)=STATEV(NmecSttv+i)
      enddo

      do i=1,Nall
        qall(i)=STATEV(NmecSttv+Nalt+i)
      enddo

      exptv=0.0d0
      exptvp=0.0d0
      alttot=0.0d0

      do i=1,Nalt
        scal=DeltXi/talti(i)
        qaltp(i)=qalt(i)*exp(-scal)+Theta*(1.0d0-exp(-scal))+
     $   (Thetap-Theta)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(NmecSttv+ i)=qaltp(i)
        exptv=exptv+alti(i)*(qaltp(i)-qalt(i))
        alttot=alttot+alti(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      explv=0.0d0
      explvp=0.0d0
      alltot=0.0d0

      do i=1,Nall
        scal=DeltXi/talli(i)
        qallp(i)=qall(i)*exp(-scal)+Theta*(1.0d0-exp(-scal))+
     $   (Thetap-Theta)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
        STATEV(NmecSttv+Nalt+i)=qallp(i)
        explv=explv+alli(i)*(qallp(i)-qall(i))
        alltot=alltot+alli(i)*(1.0d0-(1.0d0/scal)*(1.0d0-exp(-scal)))
      enddo

      EXPAN(1)=(exptgp-exptg)-exptv
      EXPAN(2)=(exptgp-exptg)-exptv
      EXPAN(3)=(explgp-explg)-explv
      DEXPANDT(1) = altg-alttot
      DEXPANDT(2) = altg-alttot
      DEXPANDT(3) = allg-alltot

      RETURN
      END